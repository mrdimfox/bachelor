\NeedsTeXFormat{LaTeX2e}

\ProvidesPackage{G2-105-95}
         [2002/12/12 v0.01 General reqs.]

\RequirePackage{multicol}	% многоколоночность
\RequirePackage{textcomp}	% ввод различных знаков
\RequirePackage{floatflt}
\RequirePackage{float}
\RequirePackage{rotating}	% вращение объектов
\RequirePackage{calc}		% для возможности численных расчетов
\RequirePackage{ifthen}
\RequirePackage{geometry}
\RequirePackage{indentfirst}	% начинать абзацы с красной строки
\RequirePackage{listings}
\RequirePackage{caption}		% оформление подписей
\RequirePackage{longtable}
\RequirePackage{footnpag}			% внешний вид сносок
\RequirePackage[bottom]{footmisc}   % для установки сносок всегда внизу страницы
\RequirePackage{everypage}	 % вывод на каждой странице
\RequirePackage{enumitem}	 % для настройки списков
\RequirePackage{titlesec}         

\newif\ifmypackage@geometry
\DeclareOption{geometry}{
    \mypackage@geometrytrue
}

\DeclareOption{nogeometry}{
    \mypackage@geometryfalse
}

\ExecuteOptions{geometry}

\ProcessOptions\relax

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Размеры шрифтов
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\renewcommand\LARGE{\@setfontsize\LARGE{17}{20.4}\selectfont}
\renewcommand\Large{\@setfontsize\Large{16}{19.2}\selectfont}
\renewcommand\large{\@setfontsize\large{15}{18}\selectfont}
\renewcommand\normalsize{\@setfontsize\normalsize{14}{14.4}\selectfont}
\renewcommand\small{\@setfontsize\small{10}{12}\selectfont}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Настройки размера страницы
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Основные отступы
\ifmypackage@geometry
    \geometry{
        a4paper,
    	left=25mm,   % 20mm + 5mm
    	right=10mm,   % 5mm + 5mm
    	top=30mm,	 % 20mm + 10mm
    	bottom=30mm  % 20mm + 10mm
    }
    \parindent=15mm
    \AddEverypageHook{%
    	\ifnum \thepage = 3%
    		% Только для первой страницы
    		\newgeometry{
    			left=25mm,	 % 20mm + 5mm
    			right=10mm,	 % 5mm + 5mm
    			top=15mm,	 % 5mm + 10mm
    			bottom=55mm  % 45mm + 10mm
    		}
    	\else%
    		\restoregeometry%
    	\fi%
    }
\fi


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Титульный лист и штампы
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\def\gostgrifsoglasovano#1{\gdef\@gostgrifsoglasovano{#1}} 
\def\gostgrifutverjdeno#1{\gdef\@gostgrifutverjdeno{#1}} 
\def\gosttitleobject#1{\gdef\@gosttitleobject{#1}}
\def\gosttitledocument#1{\gdef\@gosttitledocument{#1}} 
\def\gostklgi#1{\gdef\@gostklgi{#1}} 
\def\gosttitlecompany#1{\gdef\@gosttitlecompany{#1}} 
\def\gostutverdil#1{\gdef\@gostutverdil{#1}}
\def\gostnormokontroler#1{\gdef\@gostnormokontroler{#1}} 
\def\gostrazrabotchik#1{\gdef\@gostrazrabotchik{#1}} 
\def\gostproveril#1{\gdef\@gostproveril{#1}} 
\def\gostispolnitel#1{\gdef\@gostispolnitel{#1}} 
\def\gostlitera#1{\gdef\@gostlitera{#1}} 
\def\gostdate#1{\gdef\@gostdate{#1}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Переопределение пунктов (п.4.1.3)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\ifnum \c@secnumdepth < 4
	\newcommand{\theengost}{\thesection.\@arabic\c@engost}%              
	\newcounter{engost}[section]
\else                                                                         
   	\ifnum \c@secnumdepth < 5
		\newcommand{\theengost}{\thesubsection.\@arabic\c@engost}%
		\newcounter{engost}[subsection]
	\else                                                                       
		\ifnum \c@secnumdepth < 6
			\newcommand{\theengost}{\thesubsubsection.\@arabic\c@engost}%
			\newcounter{engost}[subsubsection]
		\else
			\ifnum \c@secnumdepth < 7
				\newcommand{\theengost}{\theparagraph.\@arabic\c@engost}%
				\newcounter{engost}[paragraph]
			\else
				\ifnum \c@secnumdepth < 8
					\newcommand{\theengost}{\thesubparagraph.\@arabic\c@engost}%
					\newcounter{engost}[subparagraph]
				\else
					\newcommand{\theengost}{\@arabic\c@engost}%
					\newcounter{engost}
				\fi
			\fi
       	\fi                                                                       
   	\fi                                                                         
\fi 


\newenvironment{engost}%
{%
	\renewcommand\item{%
		\par%
		\refstepcounter{engost}%
		\theengost
		%\arabic{section}.\arabic{subsection}.\arabic{engost}%
		\quad%
	}%
}%

\newcounter{ensubgost}[engost]	    			
\renewcommand{\theensubgost}{\theengost.\arabic{ensubgost}}%              
\newenvironment{ensubgost}
{%
	\renewcommand{\item}%
	{
		\par%
		\refstepcounter{ensubgost}%
		\theensubgost%
		\quad%
	}
}%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Раздел с новой страницы
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\gostnewpage}{\clearpage}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Переопределение вида разделов
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newlength\labelLength
\newlength\parIndent
\setlength{\parIndent}{\parindent}
\def\labelSpace{8pt}


\def\sectionSpace#1{%
    \setlength{\labelLength}{%
        \parIndent - \widthof{#1} - \labelSpace%
    }%
    \hskip \labelLength%    
}

\def\sectionLabel{\thesection}
\def\subsectionLabel{\thesubsection}
\def\subsubsectionLabel{\thesubsubsection}

\titleformat{\section}[block]
    {\bfseries\Large}
    {\sectionSpace{\sectionLabel}\sectionLabel}
    {\labelSpace}
    {}

\titleformat{\subsection}[block]
    {\bfseries\large}
    {\sectionSpace{\subsectionLabel}\subsectionLabel}
    {\labelSpace}
    {}

\titleformat{\subsubsection}[block]
    {\bfseries}
    {\sectionSpace{\subsubsectionLabel}\subsubsectionLabel}
    {\labelSpace}
    {}
    
\titleformat{name=\section,numberless}[block]
    {\bfseries\Large}
    {}
    {0pt}
    {\hspace{\parIndent}}
    
\titleformat{name=\subsection,numberless}[block]
    {\bfseries\large}
    {}
    {0pt}
    {\hspace{\parIndent}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Настройка вида подписей к рисункам и таблицам
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclareCaptionLabelSeparator{dashsep}{~---~}
\captionsetup[figure]{%
	name=Рисунок,%
	justification=centering,%
	labelsep=dashsep,%
	font=large%
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Настройка вида листингов
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\renewcommand*{\lstlistingname}{Листинг}
\DeclareCaptionLabelFormat{listing}{#1 #2}
\DeclareCaptionLabelFormat{captionAppendix}{#1 #2}
\captionsetup[lstlisting]{labelformat=listing,%
                          labelsep=dashsep,%
                          singlelinecheck=off,%
                          justification=raggedright,
                          font={stretch=1.2},
                          aboveskip=3mm}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Настройка подписей к таблице
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\captionsetup[table]{labelsep=dashsep,
                     singlelinecheck=off,%
                     justification=raggedright,
                     font={stretch=1.2},
                     aboveskip=3mm}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Сноски со скобкой
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\renewcommand\thefootnote{\@arabic\c@footnote)}%   


% Для выравнивания длинных таблиц
\LTleft=\z@
\LTright=\fill

\def\LT@makecaption#1#2#3{%                                                     
  \LT@mcol\LT@cols l{\hbox to\z@{\parbox[t]\LTcapwidth{%                    
      \sbox\@tempboxa{#1{#2\captionlabeldelim{} }#3}%                                                
          {\box\@tempboxa\hfil}%                                 
          \endgraf}%                                               
    \hss}}}

\def\NoFrames{%
	\ClearShipoutPicture%
	\renewcommand\BackgroundPicture[2]{}%
	\let\@oddfoot\@oldoddfoot%
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Исключение некоторых русских букв из алфавита 
% для нумерации приложений
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\def\GostAsbuk#1{\expandafter\@GostAsbuk\csname c@#1\endcsname}
               
\def\@GostAsbuk#1{%
	\ifcase#1\relax
	\or А\or Б\or В\or Г\or Д%
	\or Е\or Ж\or И\or К\or Л%
	\or М\or Н\or П\or Р\or С%
	\or Т\or У\or Ф\or Х\or Ц%
	\or Ш\or Ю\or Я
\else
	\@ctrerr
\fi}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Настройка ненумерованных списков
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Тире в перечислении
\renewcommand{\labelitemi}{\normalfont\bfseries{--}}

% Отступы
\setlist[itemize,1]{leftmargin=15mm, itemsep=0mm}
\setlist[itemize,2]{leftmargin=15mm, itemsep=0mm}
\setlist[itemize,3]{leftmargin=15mm, itemsep=0mm}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Настройка нумерованных списков
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Нумерация списков
\AddEnumerateCounter{\Asbuk}{\@Asbuk}{Ы}
\AddEnumerateCounter{\asbuk}{\@asbuk}{ы}
\renewcommand{\theenumi}{\asbuk{enumi})}
\renewcommand{\theenumii}{\arabic{enumii})}
\renewcommand\labelenumi{\theenumi}
\renewcommand\labelenumii{\theenumii}

% Отступы
\setlist[enumerate,1]{leftmargin=15mm, itemsep=0mm}
\setlist[enumerate,2]{leftmargin=15mm, itemsep=0mm}
\setlist[enumerate,3]{leftmargin=15mm, itemsep=0mm}

\endinput